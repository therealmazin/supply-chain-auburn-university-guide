---
title: "Step 3: Build the Model"
description: Train a machine learning model to predict late deliveries
---

# Step 3: Build the Model

Now we'll build an AI model that predicts which orders will be late.

## The Prompt

Copy and paste this prompt:

```
Build a predictive model for late deliveries:
1. Select appropriate features from the dataset
2. Split into training and testing sets
3. Train a classification model (try gradient boosting)
4. Show me the model's accuracy and key performance metrics
5. Tell me which factors are most important for predictions
```

## What Claude Code Does

Claude Code will:

1. **Select features** - Choose columns that help predict late deliveries
2. **Prepare data** - Handle categorical variables, split data
3. **Train model** - Use gradient boosting (a powerful ML algorithm)
4. **Evaluate performance** - Calculate accuracy, precision, recall
5. **Extract insights** - Show which features matter most

## Understanding the Process

### Feature Selection

The model uses information available *at the time of order*:

| Feature | Why It Helps |
|---------|--------------|
| Product category | Different products have different late rates |
| Order quantity | Larger orders are riskier |
| Facility | Some facilities perform better |
| Month ordered | Seasonal patterns matter |
| Lead time promised | Tight timelines are harder to meet |

### Train/Test Split

We split the data:
- **Training set (80%):** Model learns patterns from these orders
- **Test set (20%):** We evaluate on orders the model hasn't seen

This prevents "cheating" - we want to know how well it predicts *new* orders.

## Expected Results

### Model Performance

```
Model: Gradient Boosting Classifier

Performance Metrics:
- AUC Score: 0.726
- Accuracy: 78.3%
- Precision (Late): 62.1%
- Recall (Late): 54.8%
```

### What These Metrics Mean

| Metric | Meaning | Our Result |
|--------|---------|------------|
| **AUC** | Overall prediction quality (0.5 = random, 1.0 = perfect) | 0.726 - Good |
| **Accuracy** | % of predictions correct | 78.3% |
| **Precision** | When we predict "late," how often are we right? | 62.1% |
| **Recall** | Of all late orders, how many did we catch? | 54.8% |

### Feature Importance

Claude will show which factors matter most:

```
Feature Importance (Top 5):
1. product_category    32.4%
2. order_quantity      24.1%
3. facility           18.7%
4. month_ordered      12.3%
5. lead_time_days      8.2%
```

**Key Insight:** Product category is the strongest predictor of late delivery.

## Why Gradient Boosting?

There are many ML algorithms. Gradient boosting is good for this problem because:

- Works well with mixed data types (numbers + categories)
- Handles complex patterns
- Provides feature importance rankings
- Generally high accuracy out-of-the-box

## Honest Assessment

Is this model perfect? No.

- **AUC of 0.726** is better than guessing but not amazing
- **54.8% recall** means we miss about half of late orders
- More data and features would improve performance

But it's still valuable! Even catching half of late orders proactively is better than catching zero.

## Next Step

The model is built. Now let's validate it makes sense and assign risk scores to orders.

<Cards>
  <Card title="Next: Validate Results" href="/docs/demo-walkthrough/step-4-validate-results" />
</Cards>
